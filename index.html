<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>複数仕訳CSV作成ツール</title>
  <style>
    body { font-family: Arial, sans-serif; margin: 20px; }
    textarea { width: 100%; height: 300px; padding: 10px; font-family: monospace; }
    button { padding: 10px 20px; margin-top: 10px; background-color: #4CAF50; color: white; border: none; cursor: pointer; }
    button:hover { background-color: #45a049; }
    h1, h2 { margin-top: 20px; }
  </style>
</head>
<body>
  <h1>複数仕訳CSV作成ツール</h1>
  <p>以下の形式でExcelからコピー＆ペーストしてください（タブ区切り）：</p>
  <pre>日付	借方	借方補助	借方金額	貸方	貸方補助	貸方金額	適用</pre>
  <textarea id="inputArea" placeholder="例：
2025/05/01	普通預金	池田泉州銀行	10000	売上			売上入金"></textarea>
  <button onclick="generateCSV()">CSV出力</button>

  <h2>出力CSV</h2>
  <textarea id="outputCSV" readonly></textarea>

  <script>
    function generateCSV() {
      const input = document.getElementById('inputArea').value.trim();
      const lines = input.split('\n');
      const output = [];

      for (let i = 0; i < lines.length; i++) {
        const cols = lines[i].split('\t');
        if (cols.length < 8) continue;

        const [
          date, debitAcc, debitSub, debitAmt,
          creditAcc, creditSub, creditAmt, description
        ] = cols.map(c => c.trim());

        const debitAmount = debitAmt || creditAmt || '';
        const creditAmount = creditAmt || debitAmt || '';

        const row = [
          '1', '1', date, 'no', ('00000' + (i+1)).slice(-6),
          debitAcc, debitSub, '', '課対仕入10%込', debitAmount, '', '',
          creditAcc, creditSub, '', '課対仕入10%込', creditAmount, '', '',
          description, '', '', '', '', '', '', '', '0', '3'
        ];
        output.push(row.join(','));
      }

      document.getElementById('outputCSV').value = output.join('\n');
    }
  </script>
</body>
</html>
